<import src="../../../wxParse/wxParse.wxml"></import>
<view>
    <view class="prompt" wx:if="{{ptIng.length>0}}">
        <swiper autoplay="true" circular="true" class="swiper-content" vertical="true">
            <swiper-item wx:for="{{ptIng}}" wx:key="item.id">
                <image class="img" src="{{item.avatarurl}}"></image>
                <view class="swiper-item">{{item.nickname}}</view>
            </swiper-item>
        </swiper>
        <text class="tltle">拼了这个商品</text>
    </view>
    <swiper autoplay="true" circular="true" class="swiper" indicatorActiveColor="#69A752" indicatorColor="#B8B8B80" indicatorDots="true">
        <swiper-item wx:for="{{goods.slide_src}}" wx:key="item">
            <image src="{{item}}"></image>
        </swiper-item>
    </swiper>
    <view class="countDown-content">
        <image src="../../images/countDown.png"></image>
        <view class="countDown-wrapper">
            <view class="title">距活动结束还有</view>
            <view class="time-wrapper" style="color:{{farmSetData.assist_color}}">
                <view>{{countDown.day}}天</view>
                <view class="flex-container">
                    <view style="background:{{farmSetData.assist_color}}">{{countDown.hour}}</view>
                    <view>时</view>
                </view>
                <view class="flex-container">
                    <view style="background:{{farmSetData.assist_color}}">{{countDown.min}}</view>
                    <view>分</view>
                </view>
                <view class="flex-container">
                    <view style="background:{{farmSetData.assist_color}}">{{countDown.sec}}</view>
                    <view>秒</view>
                </view>
            </view>
        </view>
    </view>
    <view class="info-container">
        <view class="title-container">
            <view class="title">{{goods.goods_name}}</view>
            <button class="share-wrapper" openType="share">
                <text class="iconfont icon-share shareIcon"></text>
                <text>分享</text>
            </button>
        </view>
        <view class="price-container">
            <view class="price-wrapper" style="color:{{farmSetData.background_color}}">
                <text>￥</text>{{goods.pt_price}}
            </view>
            <view class="Opice-wrapper">
                <view>{{goods.price}}</view>
                <view>拼团立省{{goods.diff_price}}</view>
            </view>
            <view class="buyNum" style="color:{{farmSetData.background_color}}">已拼 {{goods.sale_count}}件</view>
        </view>
    </view>
    <view class="block"></view>
    <view class="commonTitle">拼团玩法</view>
    <view class="assem-container">
        <view class="assem-item">
            <view class="iconfont icon-wellet icons"></view>
            <view>支付开团或者参团</view>
        </view>
        <view class="assem-item">
            <view class="iconfont icon-assemble icons"></view>
            <view>邀请好友参团</view>
        </view>
        <view class="assem-item">
            <view class="iconfont icon-export icons"></view>
            <view>人数达到分别发货</view>
        </view>
        <view class="assem-item">
            <view class="iconfont icon-return icons"></view>
            <view>人数不够自动退款</view>
        </view>
    </view>
    <view class="block"></view>
    <view class="commonTitle" wx:if="{{lists.length>0}}">小伙伴在拼单，可直接参与</view>
    <view class="list-container">
        <view class="list-item" wx:if="{{item.differ>=1&&!item.finised}}" wx:for="{{lists}}" wx:key="item.id">
            <view class="flex-wrapper" style="width:60%;">
                <image src="{{item.avatarurl}}"></image>
                <view class="list-item-name">{{item.nickname}}</view>
            </view>
            <view class="flex-wrapper" style="width:65%;">
                <view class="endTime">
                    <view>还剩
                            <text style="color:{{farmSetData.background_color}}">{{item.differ}}人</text>拼成</view>
                    <view>剩余{{item.hour}}:{{item.min}}:{{item.sec}}</view>
                </view>
                <button bindtap="pinDan" class="pindan" data-relationid="{{item.id}}" style="background:{{farmSetData.background_color}}">去拼单</button>
            </view>
        </view>
    </view>
    <view class="block" wx:if="{{lists.length>0}}"></view>
    <view class="class-container">
        <view bindtap="changeClass" class="descript {{currentClass=='1'?'active':''}}" data-class="1" style="color:{{currentClass=='1'?farmSetData.background_color:''}}">商品详情</view>
        <view bindtap="changeClass" class="descript {{currentClass=='2'?'active':''}}" data-class="2" style="color:{{currentClass=='2'?farmSetData.background_color:''}}">评价</view>
    </view>
    <view hidden="{{currentClass!='1'}}">
        <view class="wxParse">
            <template is="wxParse" data="{{wxParseData:article.nodes}}"></template>
        </view>
    </view>
    <view class="comment-container" hidden="{{currentClass!='2'}}">
        <view class="comment-item" wx:if="{{commentList}}" wx:for="{{commentList}}" wx:key="item.id">
            <view class="comment-header">
                <image src="{{item.avatarurl}}"></image>
                <view>{{item.wx_nickname}}</view>
            </view>
            <view class="item-time-wrapper">
                <view>{{item.create_time}}</view>
                <view wx:if="{{item.sku_name!='[]'}}">规格:{{item.sku_name}}</view>
            </view>
            <view class="item-comment">{{item.content}}</view>
            <view class="item-comment-imgs" wx:if="{{item.src&&item.src.length>0}}">
                <image bindtap="previewImg" data-commentid="{{item.id}}" data-index="{{index}}" src="{{img}}" wx:for="{{item.src}}" wx:for-item="img" wx:key="index"></image>
            </view>
        </view>
        <view class="comment-container" style="padding:10rpx 0 10rpx 0" wx:if="{{commentList.length==0}}">
            <view class="none-comment">暂时还没有评价哦</view>
        </view>
    </view>
    <view class="footer-block"></view>
    <view class="footer" style="padding-bottom: {{isFullScreen?'34':''}}px">
        <view class="icons-wrapper">
            <view class="icon-item">
                <button bindtap="goHome">
                    <view class="iconfont icon-index f40"></view>
                    <view class="text">首页</view>
                </button>
            </view>
            <view class="icon-item">
                <button openType="contact">
                    <view class="iconfont icon-contact f40"></view>
                    <view class="text">客服</view>
                </button>
            </view>
        </view>
        <view class="btn-content">
            <view class="btns" style="background:linear-gradient(to right, {{farmSetData.background_color}},{{farmSetData.assist_color}})">
                <form bindsubmit="selectSpec" data-types="1" reportSubmit="true">
                    <button class="form-btns" formType="submit" wx:if="{{uid}}">
                        <view>
                            <text>￥</text>{{goods.price}}</view>
                        <view>单独购买</view>
                    </button>
                    <button bindgetuserinfo="updateUserInfo" class="form-btns" openType="getUserInfo" wx:else>
                        <view>
                            <text>￥</text>{{goods.price}}</view>
                        <view>单独购买</view>
                    </button>
                </form>
            </view>
            <view class="btns" style="background:{{farmSetData.background_color}}">
                <form bindsubmit="selectSpec" data-types="2" reportSubmit="true">
                    <button class="form-btns" formType="submit" wx:if="{{uid}}">
                        <view>
                            <text>￥</text>{{goods.pt_price}}
                        </view>
                        <view>发起拼单</view>
                    </button>
                    <button bindgetuserinfo="updateUserInfo" class="form-btns" openType="getUserInfo" wx:else>
                        <view>
                            <text>￥</text>{{goods.pt_price}}
                        </view>
                        <view>发起拼单</view>
                    </button>
                </form>
            </view>
        </view>
    </view>
</view>
<view bindtap="selectSpec" catchtouchmove="preventTouchMove" class="modal" wx:if="{{isSelect}}"></view>
<view class="specContainer {{isSelect?'show':'hide1'}}" style="height:{{isFullScreen?'818rpx':'750rpx'}}">
    <view class="info-content">
        <image src="{{selectSpec.spec_src}}" wx:if="{{selectSpec.spec_src}}"></image>
        <image src="{{goods.cover}}" wx:else></image>
        <view class="info-contents">
            <view style="color:{{farmSetData.background_color}}" wx:if="{{buy_types==1}}">
                <view wx:if="{{selectSpec.price}}">¥{{selectSpec.price}}</view>
                <view wx:else>¥{{goods.price}}</view>
            </view>
            <view style="color:{{farmSetData.background_color}}" wx:if="{{buy_types==2}}">
                <view wx:if="{{selectSpec.pt_price}}">¥{{selectSpec.pt_price}}</view>
                <view wx:else>¥{{goods.pt_price}}</view>
            </view>
            <view wx:if="{{selectSpec.count}}">库存: {{selectSpec.count}}</view>
            <view wx:else>库存: {{goods.count}}</view>
            <view class="info-selected">
                <view style="color: #000;">已选择:</view>
                <view class="selected-spec">{{selected}}</view>
                <view>数量:</view>
                <view class="ml10">{{selectNum}}</view>
            </view>
        </view>
    </view>
    <view class="line"></view>
    <view class="spec-content" style="max-height:{{isFullScreen?'380rpx':'320rpx'}}">
        <block wx:for="{{spec}}" wx:key="item.id">
            <view class="spec-title">{{item.name}}</view>
            <view class="spec-wrapper">
                <view bindtap="selected" data-specid="{{item.id}}" data-valid="{{val.id}}" style="background:{{val.selected?'#09BB07':'#ececec'}};color:{{val.selected?'white':'black'}}" wx:for="{{item.specVal}}" wx:for-item="val" wx:key="val">{{val.spec_value}}</view>
            </view>
        </block>
    </view>
    <view class="selected-num-content">
        <view>数量</view>
        <view class="selectedNum-wrapper">
            <view bindtap="reduce">-</view>
            <input bindinput="inputNum" type="number" value="{{selectNum}}"></input>
            <view bindtap="add">+</view>
        </view>
    </view>
    <form bindsubmit="confirmOrder" reportSubmit="true">
        <button class="confrim" formType="submit" style="background:{{farmSetData.background_color}}">确定</button>
    </form>
</view>
<wxs module="tools" src="index.wxs" />